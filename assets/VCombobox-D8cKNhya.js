import{p as re,ad as j,ae as k,af as J,ag as we,ah as p,ai as Se,aj as Ie,ak as Me,al as Pe,f as Ae,g as _e,i as De,am as B,an as ae,ao as Ke,j as Re,ap as Le,aq as U,ar as Ee,n as Oe,S as ne,s as c,F as X,C as Te,x as T,G as je,N as ue,as as Ne,at as Be,a0 as Ue,V as oe,au as ze,av as He,aw as $e,A as Ge,ax as Qe,ay as We,az as z,aA as Je,aB as ie,aC as Xe}from"./app-CgYTy_-w.js";const Ye=(e,v,t)=>e==null||v==null?-1:e.toString().toLocaleLowerCase().indexOf(v.toString().toLocaleLowerCase()),Ze=re({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function qe(e,v,t){var b;const n=[],w=(t==null?void 0:t.default)??Ye,h=t!=null&&t.filterKeys?p(t.filterKeys):!1,m=Object.keys((t==null?void 0:t.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return n;e:for(let g=0;g<e.length;g++){const[F,D=F]=p(e[g]),S={},r={};let u=-1;if((v||m>0)&&!(t!=null&&t.noFilter)){if(typeof F=="object"){const E=h||Object.keys(D);for(const M of E){const H=Se(D,M),N=(b=t==null?void 0:t.customKeyFilter)==null?void 0:b[M];if(u=N?N(H,v,F):w(H,v,F),u!==-1&&u!==!1)N?S[M]=u:r[M]=u;else if((t==null?void 0:t.filterMode)==="every")continue e}}else u=w(F,v,F),u!==-1&&u!==!1&&(r.title=u);const I=Object.keys(r).length,K=Object.keys(S).length;if(!I&&!K||(t==null?void 0:t.filterMode)==="union"&&K!==m&&!I||(t==null?void 0:t.filterMode)==="intersection"&&(K!==m||!I))continue}n.push({index:g,matches:{...r,...S}})}return n}function pe(e,v,t,n){const w=j([]),h=j(new Map),m=k(()=>J(v));we(()=>{const g=typeof t=="function"?t():J(t),F=typeof g!="string"&&typeof g!="number"?"":String(g),D=qe(m.value,F,{customKeyFilter:{...e.customKeyFilter,...J(n==null?void 0:n.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),S=J(v),r=[],u=new Map;D.forEach(I=>{let{index:K,matches:E}=I;const M=S[K];r.push(M),u.set(M.value,E)}),w.value=r,h.value=u});function b(g){return h.value.get(g.value)}return{filteredItems:w,filteredMatches:h,getMatches:b}}function el(e,v,t){if(v==null)return e;if(Array.isArray(v))throw new Error("Multiple matches is not implemented");return typeof v=="number"&&~v?c(X,null,[c("span",{class:"v-combobox__unmask"},[e.substr(0,v)]),c("span",{class:"v-combobox__mask"},[e.substr(v,t)]),c("span",{class:"v-combobox__unmask"},[e.substr(v+t)])]):e}const ll=re({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Ze({filterKeys:["title"]}),...Ie({hideNoData:!0,returnObject:!0}),...Me(Pe({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Ae({transition:!1})},"VCombobox"),al=_e()({name:"VCombobox",props:ll(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,v){var ee;let{emit:t,slots:n}=v;const{t:w}=De(),h=j(),m=B(!1),b=B(!0),g=B(!1),F=j(),D=j(),S=ae(e,"menu"),r=k({get:()=>S.value,set:l=>{var o;S.value&&!l&&((o=F.value)!=null&&o.Î¨openChildren)||(S.value=l)}}),u=B(-1);let I=!1;const K=k(()=>{var l;return(l=h.value)==null?void 0:l.color}),E=k(()=>r.value?e.closeText:e.openText),{items:M,transformIn:H,transformOut:N}=Ke(e),{textColorClasses:se,textColorStyles:ce}=Re(K),i=ae(e,"modelValue",[],l=>H(p(l)),l=>{const o=N(l);return e.multiple?o:o[0]??null}),O=Le(),$=k(()=>!!(e.chips||n.chip)),P=k(()=>$.value||!!n.selection),A=B(!e.multiple&&!P.value?((ee=i.value[0])==null?void 0:ee.title)??"":""),d=k({get:()=>A.value,set:l=>{var o;if(A.value=l??"",!e.multiple&&!P.value&&(i.value=[z(e,l)]),l&&e.multiple&&((o=e.delimiters)!=null&&o.length)){const f=l.split(new RegExp(`(?:${e.delimiters.join("|")})+`));f.length>1&&(f.forEach(a=>{a=a.trim(),a&&C(z(e,a))}),A.value="")}l||(u.value=-1),b.value=!l}}),ve=k(()=>typeof e.counterValue=="function"?e.counterValue(i.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?i.value.length:d.value.length);U(A,l=>{I?ie(()=>I=!1):m.value&&!r.value&&(r.value=!0),t("update:search",l)}),U(i,l=>{var o;!e.multiple&&!P.value&&(A.value=((o=l[0])==null?void 0:o.title)??"")});const{filteredItems:G,getMatches:fe}=pe(e,M,()=>b.value?"":d.value),_=k(()=>e.hideSelected?G.value.filter(l=>!i.value.some(o=>o.value===l.value)):G.value),de=k(()=>i.value.map(l=>l.value)),Y=k(()=>{var o;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&d.value===((o=_.value[0])==null?void 0:o.title))&&_.value.length>0&&!b.value&&!g.value}),Z=k(()=>e.hideNoData&&!_.value.length||e.readonly||(O==null?void 0:O.isReadonly.value)),q=j(),{onListScroll:me,onListKeydown:he}=Ee(q,h);function ge(l){I=!0,e.openOnClear&&(r.value=!0)}function ye(){Z.value||(r.value=!0)}function be(l){Z.value||(m.value&&(l.preventDefault(),l.stopPropagation()),r.value=!r.value)}function xe(l){var a;if(Je(l)||e.readonly||O!=null&&O.isReadonly.value)return;const o=h.value.selectionStart,f=i.value.length;if((u.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(r.value=!0),["Escape"].includes(l.key)&&(r.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(Y.value&&["Enter","Tab"].includes(l.key)&&!i.value.some(s=>{let{value:V}=s;return V===_.value[0].value})&&C(G.value[0]),b.value=!0),l.key==="ArrowDown"&&Y.value&&((a=q.value)==null||a.focus("next")),l.key==="Enter"&&d.value&&(C(z(e,d.value)),P.value&&(A.value="")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&P.value&&i.value.length>0&&!d.value)return C(i.value[0],!1);if(~u.value){const s=u.value;C(i.value[u.value],!1),u.value=s>=f-1?f-2:s}else l.key==="Backspace"&&!d.value&&(u.value=f-1)}if(e.multiple){if(l.key==="ArrowLeft"){if(u.value<0&&o>0)return;const s=u.value>-1?u.value-1:f-1;i.value[s]?u.value=s:(u.value=-1,h.value.setSelectionRange(d.value.length,d.value.length))}if(l.key==="ArrowRight"){if(u.value<0)return;const s=u.value+1;i.value[s]?u.value=s:(u.value=-1,h.value.setSelectionRange(0,0))}}}function Ve(){var l;m.value&&(b.value=!0,(l=h.value)==null||l.focus())}function C(l){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const f=i.value.findIndex(s=>e.valueComparator(s.value,l.value)),a=o??!~f;if(~f){const s=a?[...i.value,l]:[...i.value];s.splice(f,1),i.value=s}else a&&(i.value=[...i.value,l]);e.clearOnSelect&&(d.value="")}else{const f=o!==!1;i.value=f?[l]:[],A.value=f&&!P.value?l.title:"",ie(()=>{r.value=!1,b.value=!0})}}function ke(l){m.value=!0,setTimeout(()=>{g.value=!0})}function Fe(l){g.value=!1}function Ce(l){(l==null||l===""&&!e.multiple&&!P.value)&&(i.value=[])}return U(m,(l,o)=>{if(!(l||l===o)&&(u.value=-1,r.value=!1,d.value)){if(e.multiple){C(z(e,d.value));return}if(!P.value)return;i.value.some(f=>{let{title:a}=f;return a===d.value})?A.value="":C(z(e,d.value))}}),U(r,()=>{if(!e.hideSelected&&r.value&&i.value.length){const l=_.value.findIndex(o=>i.value.some(f=>e.valueComparator(f.value,o.value)));Xe&&window.requestAnimationFrame(()=>{var o;l>=0&&((o=D.value)==null||o.scrollToIndex(l))})}}),U(()=>e.items,(l,o)=>{r.value||m.value&&!o.length&&l.length&&(r.value=!0)}),Oe(()=>{const l=!!(!e.hideNoData||_.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),o=i.value.length>0,f=ne.filterProps(e);return c(ne,T({ref:h},f,{modelValue:d.value,"onUpdate:modelValue":[a=>d.value=a,Ce],focused:m.value,"onUpdate:focused":a=>m.value=a,validationValue:i.externalValue,counterValue:ve.value,dirty:o,class:["v-combobox",{"v-combobox--active-menu":r.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!P.value,"v-combobox--selecting-index":u.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:e.readonly,placeholder:o?void 0:e.placeholder,"onClick:clear":ge,"onMousedown:control":ye,onKeydown:xe}),{...n,default:()=>c(X,null,[c(Te,T({ref:F,modelValue:r.value,"onUpdate:modelValue":a=>r.value=a,activator:"parent",contentClass:"v-combobox__content",disabled:Z.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Ve},e.menuProps),{default:()=>[l&&c(je,T({ref:q,selected:de.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),onKeydown:he,onFocusin:ke,onFocusout:Fe,onScrollPassive:me,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var a,s,V;return[(a=n["prepend-item"])==null?void 0:a.call(n),!_.value.length&&!e.hideNoData&&(((s=n["no-data"])==null?void 0:s.call(n))??c(ue,{title:w(e.noDataText)},null)),c(Ne,{ref:D,renderless:!0,items:_.value},{default:R=>{var te;let{item:y,index:L,itemRef:x}=R;const le=T(y.props,{ref:x,key:L,active:Y.value&&L===0?!0:void 0,onClick:()=>C(y,null)});return((te=n.item)==null?void 0:te.call(n,{item:y,index:L,props:le}))??c(ue,T(le,{role:"option"}),{prepend:Q=>{let{isSelected:W}=Q;return c(X,null,[e.multiple&&!e.hideSelected?c(Be,{key:y.value,modelValue:W,ripple:!1,tabindex:"-1"},null):void 0,y.props.prependAvatar&&c(Ue,{image:y.props.prependAvatar},null),y.props.prependIcon&&c(oe,{icon:y.props.prependIcon},null)])},title:()=>{var Q,W;return b.value?y.title:el(y.title,(Q=fe(y))==null?void 0:Q.title,((W=d.value)==null?void 0:W.length)??0)}})}}),(V=n["append-item"])==null?void 0:V.call(n)]}})]}),i.value.map((a,s)=>{function V(x){x.stopPropagation(),x.preventDefault(),C(a,!1)}const R={"onClick:close":V,onKeydown(x){x.key!=="Enter"&&x.key!==" "||(x.preventDefault(),x.stopPropagation(),V(x))},onMousedown(x){x.preventDefault(),x.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},y=$.value?!!n.chip:!!n.selection,L=y?ze($.value?n.chip({item:a,index:s,props:R}):n.selection({item:a,index:s})):void 0;if(!(y&&!L))return c("div",{key:a.value,class:["v-combobox__selection",s===u.value&&["v-combobox__selection--selected",se.value]],style:s===u.value?ce.value:{}},[$.value?n.chip?c($e,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:a.title}}},{default:()=>[L]}):c(He,T({key:"chip",closable:e.closableChips,size:"small",text:a.title,disabled:a.props.disabled},R),null):L??c("span",{class:"v-combobox__selection-text"},[a.title,e.multiple&&s<i.value.length-1&&c("span",{class:"v-combobox__selection-comma"},[Ge(",")])])])})]),"append-inner":function(){var R;for(var a=arguments.length,s=new Array(a),V=0;V<a;V++)s[V]=arguments[V];return c(X,null,[(R=n["append-inner"])==null?void 0:R.call(n,...s),(!e.hideNoData||e.items.length)&&e.menuIcon?c(oe,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:be,onClick:Qe,"aria-label":w(E.value),title:w(E.value),tabindex:"-1"},null):void 0])}})}),We({isFocused:m,isPristine:b,menu:r,search:d,selectionIndex:u,filteredItems:G,select:C},h)}});export{al as V};
